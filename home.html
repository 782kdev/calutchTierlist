<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minecraft Crystal Leaderboard</title>
<style>
  body {
    background-color: #0f1720;
    color: white;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
  }
  .container {
    max-width: 800px;
    margin: 60px auto;
    padding: 20px;
    background: #1e293b;
    border-radius: 10px;
  }
  h1 {
    text-align: center;
    color: #ffd166;
  }
  #addPlayerBtn {
    display: inline-block;
    margin-bottom: 20px;
    padding: 10px 15px;
    background: #06d6a0;
    color: #0f1720;
    font-weight: bold;
    border: none;
    border-radius: 8px;
    cursor: pointer;
  }
  .rank-row {
    display: flex;
    align-items: center;
    background: #2d3e50;
    margin-bottom: 10px;
    padding: 8px;
    border-radius: 8px;
  }
  .avatar img {
    width: 48px;
    height: 48px;
    border-radius: 6px;
    margin-right: 12px;
  }
  .player-meta {
    flex: 1;
  }
  .player-name {
    font-weight: bold;
  }
  .region {
    font-size: 12px;
    color: #9aa6b2;
    margin-left: 4px;
  }
  .tiers {
    margin-right: 10px;
  }
  .tier {
    background: #ffd166;
    padding: 4px 8px;
    border-radius: 6px;
    color: #0f1720;
    font-weight: bold;
  }
  .actions button {
    background: transparent;
    border: none;
    cursor: pointer;
    color: white;
    font-size: 16px;
    margin-left: 5px;
  }
  /* Modal styling */
  .modal {
    display: none;
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.6);
    justify-content: center;
    align-items: center;
    z-index: 100;
  }
  .modal-content {
    background: #1e293b;
    padding: 20px;
    border-radius: 8px;
    min-width: 300px;
  }
  .modal-content input, .modal-content select {
    width: 100%;
    padding: 8px;
    margin: 6px 0;
    border: none;
    border-radius: 6px;
  }
  .modal-content button {
    padding: 8px 14px;
    background: #06d6a0;
    color: #0f1720;
    font-weight: bold;
    border: none;
    border-radius: 8px;
    cursor: pointer;
  }
</style>
</head>
<body>

<div class="container">
  <h1>Crystal PvP Leaderboard</h1>
  <button id="addPlayerBtn">Add Player</button>
  <div id="rankList"></div>
</div>

<!-- Admin Button -->
<button id="adminBtn" style="
  position: fixed;
  right: 20px;
  top: 20px;
  background: #ffd166;
  color: #0f1720;
  padding: 8px 14px;
  font-weight: bold;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  z-index: 1000;
">Admin</button>

<!-- Player Modal -->
<div id="playerModal" class="modal">
  <div class="modal-content">
    <h2 id="modalTitle">Add Player</h2>
    <input type="text" id="username" placeholder="Username">
    <select id="region">
      <option value="NA">NA</option>
      <option value="EU">EU</option>
      <option value="AS">AS</option>
    </select>
    <input type="text" id="skinUrl" placeholder="Minecraft Skin URL">
    <input type="text" id="crystalTier" placeholder="Crystal Tier">
    <button id="savePlayer">Save</button>
  </div>
</div>

<script>
const addBtn = document.getElementById('addPlayerBtn');
const modal = document.getElementById('playerModal');
const saveBtn = document.getElementById('savePlayer');
const rankList = document.getElementById('rankList');
const modalTitle = document.getElementById('modalTitle');
const adminBtn = document.getElementById('adminBtn');

let editIndex = null;

// Load admin status from localStorage
let isOwner = localStorage.getItem("isOwner") === "true";

// Toggle button text
function updateAdminBtn() {
  adminBtn.textContent = isOwner ? "Logout Admin" : "Admin";
  addBtn.style.display = isOwner ? "inline-block" : "none";
}

// Render players
function renderPlayers() {
  rankList.innerHTML = '';
  const players = JSON.parse(localStorage.getItem('players') || '[]');
  if(players.length === 0){
    rankList.innerHTML = '<div style="color:#9aa6b2;text-align:center;padding:12px;">No players yet</div>';
  } else {
    players.forEach((player, index)=>{
      const row = document.createElement('div');
      row.className = 'rank-row';
      row.innerHTML = `
        <div class="avatar"><img src="${player.skinUrl}" alt="${player.username} skin"></div>
        <div class="player-meta">
          <div class="player-name">${player.username} <span class="region">${player.region}</span></div>
        </div>
        <div class="tiers"><div class="tier">${player.tier}</div></div>
        <div class="actions" style="display:${isOwner ? 'block' : 'none'}">
          <button onclick="editPlayer(${index})">‚úèÔ∏è</button>
          <button onclick="removePlayer(${index})">üóëÔ∏è</button>
        </div>
      `;
      rankList.appendChild(row);
    });
  }
}

// Open modal
function openModal(edit=false){
  modal.style.display='flex';
  if(edit){
    modalTitle.textContent = 'Edit Player';
  } else {
    modalTitle.textContent = 'Add Player';
    document.getElementById('username').value='';
    document.getElementById('skinUrl').value='';
    document.getElementById('crystalTier').value='';
    document.getElementById('region').value='NA';
  }
}

// Edit player
function editPlayer(index){
  const players = JSON.parse(localStorage.getItem('players') || '[]');
  const player = players[index];
  editIndex = index;
  document.getElementById('username').value=player.username;
  document.getElementById('region').value=player.region;
  document.getElementById('skinUrl').value=player.skinUrl;
  document.getElementById('crystalTier').value=player.tier;
  openModal(true);
}

// Remove player
function removePlayer(index){
  const players = JSON.parse(localStorage.getItem('players') || '[]');
  players.splice(index, 1);
  localStorage.setItem('players', JSON.stringify(players));
  renderPlayers();
}

// Add button click
addBtn.addEventListener('click', e=>{
  e.preventDefault();
  if(!isOwner) return alert("Admin only!");
  editIndex = null;
  openModal(false);
});

// Save player
saveBtn.addEventListener('click', ()=>{
  const username = document.getElementById('username').value.trim();
  const region = document.getElementById('region').value;
  const skinUrl = document.getElementById('skinUrl').value.trim();
  const tier = document.getElementById('crystalTier').value.trim();

  if(!username || !skinUrl || !tier) return alert('Please fill all fields');

  const players = JSON.parse(localStorage.getItem('players') || '[]');

  if(editIndex !== null){
    players[editIndex] = {username, region, skinUrl, tier};
  } else {
    players.push({username, region, skinUrl, tier});
  }
  localStorage.setItem('players', JSON.stringify(players));

  renderPlayers();
  modal.style.display='none';
  editIndex = null;
});

// Modal close
modal.addEventListener('click', e=>{
  if(e.target === modal) modal.style.display='none';
});

// Admin button click
adminBtn.addEventListener("click", () => {
  if(isOwner){
    // Logout
    localStorage.removeItem("isOwner");
    isOwner = false;
    updateAdminBtn();
    renderPlayers();
  } else {
    // Login
    const pass = prompt("Enter admin password:");
    if(pass === "clutchadmin112"){
      localStorage.setItem("isOwner", "true");
      isOwner = true;
      updateAdminBtn();
      renderPlayers();
    } else {
      alert("Incorrect password!");
    }
  }
});

// On page load
updateAdminBtn();
renderPlayers();
</script>

</body>
</html>
