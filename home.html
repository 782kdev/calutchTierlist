<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Player Leaderboard</title>
<style>
:root {
  --bg: #1c1f26;
  --card-bg: #232732;
  --pill-bg: #2e3440;
  --muted: #9aa6b2;
}
body {
  font-family: Arial, sans-serif;
  background: var(--bg);
  color: white;
  margin: 0;
  padding: 0;
}
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--card-bg);
  padding: 12px 20px;
}
.header h1 {
  margin: 0;
  font-size: 20px;
}
.search input {
  padding: 6px 10px;
  border: none;
  border-radius: 6px;
}
button {
  cursor: pointer;
}
.rank-list {
  padding: 20px;
}
.rank-row {
  display: flex;
  align-items: center;
  background: var(--card-bg);
  margin-bottom: 10px;
  padding: 8px;
  border-radius: 8px;
  transition: background 0.2s;
}
.rank-row:hover {
  background: #2b2f3a;
}
.avatar img {
  width: 40px;
  height: 40px;
}
.player-meta {
  flex: 1;
  margin-left: 10px;
}
.player-name {
  font-weight: bold;
}
.region {
  font-size: 12px;
  color: var(--muted);
}
.tiers .tier {
  background: var(--pill-bg);
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 12px;
}
.actions {
  display: none;
  gap: 4px;
}
.actions button {
  background: none;
  border: none;
  color: white;
}
.admin-visible .actions {
  display: flex;
}
#addPlayerBtn {
  display: none;
  margin: 12px;
  padding: 8px 12px;
  background: #3b82f6;
  border: none;
  color: white;
  border-radius: 6px;
}
.admin-visible #addPlayerBtn {
  display: inline-block;
}
/* Modal base */
.modal {
  display: none;
  position: fixed;
  z-index: 10;
  inset: 0;
  background: rgba(0,0,0,0.6);
  align-items: center;
  justify-content: center;
}
.modal-content {
  background: var(--card-bg);
  padding: 20px;
  border-radius: 8px;
  width: 300px;
}
.modal-content input, .modal-content select {
  width: 100%;
  padding: 6px;
  margin: 4px 0;
  border: none;
  border-radius: 6px;
}
.modal-content button {
  background: #3b82f6;
  border: none;
  color: white;
  padding: 6px 10px;
  border-radius: 6px;
}
/* Details modal */
.details-content {
  background: var(--card-bg);
  padding: 20px;
  border-radius: 8px;
  text-align: center;
}
.details-content img {
  width: 100px;
  height: 100px;
}
.details-tier {
  display: inline-block;
  padding: 6px 8px;
  border-radius: 8px;
  background: var(--pill-bg);
  color: var(--muted);
  font-weight: 700;
  margin-top: 8px;
}
</style>
</head>
<body>
<div class="header">
  <h1>Leaderboard</h1>
  <div class="search"><input type="text" placeholder="Search player..."></div>
  <button id="adminBtn">Admin</button>
</div>
<button id="addPlayerBtn">Add Player</button>
<div class="rank-list" id="rankList"></div>

<!-- Add/Edit Player Modal -->
<div class="modal" id="playerModal">
  <div class="modal-content">
    <h2 id="modalTitle">Add Player</h2>
    <input type="text" id="username" placeholder="Username">
    <select id="region">
      <option value="NA">NA</option>
      <option value="EU">EU</option>
      <option value="AS">AS</option>
    </select>
    <input type="text" id="skinUrl" placeholder="Skin PNG URL">
    <input type="text" id="crystalTier" placeholder="Crystal Tier">
    <button id="savePlayer">Save</button>
  </div>
</div>

<!-- Details Modal -->
<div class="modal" id="detailsModal">
  <div class="details-content">
    <img id="detailsSkin" src="" alt="Player Skin">
    <h3 id="detailsName"></h3>
    <div class="region" id="detailsRegion"></div>
    <div class="details-tier" id="detailsTier"></div>
  </div>
</div>

<script>
const addBtn = document.getElementById('addPlayerBtn');
const modal = document.getElementById('playerModal');
const saveBtn = document.getElementById('savePlayer');
const rankList = document.getElementById('rankList');
const modalTitle = document.getElementById('modalTitle');

const detailsModal = document.getElementById('detailsModal');
const detailsSkin = document.getElementById('detailsSkin');
const detailsName = document.getElementById('detailsName');
const detailsRegion = document.getElementById('detailsRegion');
const detailsTier = document.getElementById('detailsTier');

const searchInput = document.querySelector('.search input');
const adminBtn = document.getElementById('adminBtn');

let editIndex = null;

function renderPlayers() {
  rankList.innerHTML = '';
  const players = JSON.parse(localStorage.getItem('players') || '[]');
  if(players.length === 0){
    rankList.innerHTML = '<div style="color:#9aa6b2;text-align:center;padding:12px;">No players yet</div>';
  } else {
    players.forEach((player, index)=>{
      const row = document.createElement('div');
      row.className = 'rank-row';
      row.innerHTML = `
        <div class="avatar"><img src="${player.skinUrl}" alt="${player.username} skin"></div>
        <div class="player-meta">
          <div class="player-name">${player.username} <span class="region">${player.region}</span></div>
        </div>
        <div class="tiers"><div class="tier">${player.tier}</div></div>
        <div class="actions">
          <button onclick="editPlayer(${index});event.stopPropagation();">‚úèÔ∏è</button>
          <button onclick="removePlayer(${index});event.stopPropagation();">üóëÔ∏è</button>
        </div>
      `;
      row.addEventListener('click', () => showDetails(player));
      rankList.appendChild(row);
    });
  }
}

function openModal(edit=false){
  modal.style.display='flex';
  if(edit){
    modalTitle.textContent = 'Edit Player';
  } else {
    modalTitle.textContent = 'Add Player';
    document.getElementById('username').value='';
    document.getElementById('skinUrl').value='';
    document.getElementById('crystalTier').value='';
    document.getElementById('region').value='NA';
  }
}

function editPlayer(index){
  const players = JSON.parse(localStorage.getItem('players') || '[]');
  const player = players[index];
  editIndex = index;
  document.getElementById('username').value=player.username;
  document.getElementById('region').value=player.region;
  document.getElementById('skinUrl').value=player.skinUrl;
  document.getElementById('crystalTier').value=player.tier;
  openModal(true);
}

function removePlayer(index){
  const players = JSON.parse(localStorage.getItem('players') || '[]');
  players.splice(index, 1);
  localStorage.setItem('players', JSON.stringify(players));
  renderPlayers();
}

function showDetails(player){
  detailsSkin.src = player.skinUrl;
  detailsName.textContent = player.username;
  detailsRegion.textContent = player.region;
  detailsTier.textContent = player.tier;
  detailsModal.style.display = 'flex';
}

addBtn.addEventListener('click', e=>{
  e.preventDefault();
  editIndex = null;
  openModal(false);
});

saveBtn.addEventListener('click', ()=>{
  const username = document.getElementById('username').value.trim();
  const region = document.getElementById('region').value;
  const skinUrl = document.getElementById('skinUrl').value.trim();
  const tier = document.getElementById('crystalTier').value.trim();

  if(!username || !skinUrl || !tier) return alert('Please fill all fields');

  const players = JSON.parse(localStorage.getItem('players') || '[]');

  if(editIndex !== null){
    players[editIndex] = {username, region, skinUrl, tier};
  } else {
    players.push({username, region, skinUrl, tier});
  }
  localStorage.setItem('players', JSON.stringify(players));

  renderPlayers();
  modal.style.display='none';
  editIndex = null;
});

modal.addEventListener('click', e=>{
  if(e.target === modal) modal.style.display='none';
});

detailsModal.addEventListener('click', e=>{
  if(e.target === detailsModal) detailsModal.style.display='none';
});

// Search
searchInput.addEventListener('keydown', function(e){
  if(e.key === 'Enter'){
    const query = searchInput.value.trim().toLowerCase();
    if(!query) return;
    const players = JSON.parse(localStorage.getItem('players') || '[]');
    const found = players.find(p => p.username.toLowerCase() === query);
    if(found){
      showDetails(found);
    } else {
      alert("Player does not exist");
    }
  }
});

// Admin
adminBtn.addEventListener('click', ()=>{
  const pass = prompt("Enter admin password:");
  if(pass === "clutchadmin112"){
    document.body.classList.add('admin-visible');
    localStorage.setItem('isAdmin', 'true');
  } else {
    alert("Wrong password");
  }
});

// Keep admin after refresh
if(localStorage.getItem('isAdmin') === 'true'){
  document.body.classList.add('admin-visible');
}

renderPlayers();
</script>
</body>
</html>
